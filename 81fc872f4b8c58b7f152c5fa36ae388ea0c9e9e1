---
type: patterns
timestamp: '2025-12-24T18:55:11.081621+00:00'
summary: '...analyzers/log_analyzer.py` and `analyzers/analyze_cli.py`'
tags:
- auto-captured
- post-tool-use
- file:CODE_REVIEW.md
---

...analyzers/log_analyzer.py` and `analyzers/analyze_cli.py`

**Description:** Both files contain similar pattern matching and analysis logic for prompt logs.

**Impact:** Maintenance burden, risk of divergent...

---
type: patterns
timestamp: '2025-12-24T18:55:11.102504+00:00'
summary: '...High coupling, difficult to modify independently.'
tags:
- auto-captured
- post-tool-use
- file:CODE_REVIEW.md
---

...High coupling, difficult to modify independently.

**Remediation:** Use artifact registry pattern for inter-step communication.

### QUAL-004: Complex Conditional in Pipeline (MEDIUM)

**File:**...

---
type: patterns
timestamp: '2025-12-24T18:56:54.647657+00:00'
summary: '...Validate branch name format before git commands'
tags:
- auto-captured
- post-tool-use
- file:create-issue-worktree.sh
---

...Validate branch name format before git commands
    # Branch names must match: prefix/number-slug pattern
    if ! [[ "$branch" =~ ^[a-z]+/[0-9]+-[a-z0-9-]+$ ]]; then
        echo "Error: Invalid branch...

---
type: patterns
timestamp: '2025-12-24T18:57:18.154557+00:00'
summary: '...for base64 segment to be considered for decoding'
tags:
- auto-captured
- post-tool-use
- file:pipeline.py
---

...for base64 segment to be considered for decoding
MIN_BASE64_SEGMENT_LENGTH = 20

# Base64 pattern for detecting encoded content
# Matches strings of MIN_BASE64_SEGMENT_LENGTH+ base64 characters...

---
type: patterns
timestamp: '2025-12-24T19:19:47.803889+00:00'
summary: '...────────────────────────`

  The command injection vulnerability in bash scripts is a classic sec...'
tags:
- auto-captured
- pre-compact
---

...────────────────────────`
The command injection vulnerability in bash scripts is a classic security pattern - when parsing JSON from external sources (GitHub API), values like issue titles can contain...

---
type: patterns
timestamp: '2025-12-24T19:22:53.133163+00:00'
summary: '...created from GitHub issue data without secret filtering.'
tags:
- auto-captured
- post-tool-use
- file:CODE_REVIEW.md
---

...created from GitHub issue data without secret filtering.

---

### PERF-MED-001: Multiple Regex Pattern Iterations

**File:** `filters/pipeline.py:340-354`

**Description:** `detect_secrets()` iterates...

---
type: patterns
timestamp: '2025-12-24T19:23:33.667709+00:00'
summary: '...────────────────────────`

  The command injection vulnerability in bash scripts is a classic sec...'
tags:
- auto-captured
- pre-compact
---

...────────────────────────`
The command injection vulnerability in bash scripts is a classic security pattern - when parsing JSON from external sources (GitHub API), values like issue titles can contain...

---
type: patterns
timestamp: '2025-12-24T19:33:26.548349+00:00'
summary: '...────────────────────────`

  The command injection vulnerability in bash scripts is a classic sec...'
tags:
- auto-captured
- pre-compact
---

...────────────────────────`
The command injection vulnerability in bash scripts is a classic security pattern - when parsing JSON from external sources (GitHub API), values like issue titles can contain...

---
type: patterns
timestamp: '2025-12-24T19:44:32.917623+00:00'
summary: '...────────────────────────`

  The command injection vulnerability in bash scripts is a classic sec...'
tags:
- auto-captured
- pre-compact
---

...────────────────────────`
The command injection vulnerability in bash scripts is a classic security pattern - when parsing JSON from external sources (GitHub API), values like issue titles can contain...

---
type: patterns
timestamp: '2025-12-24T19:46:33.619924+00:00'
summary: '...| as delimiter since paths may contain /'
tags:
- auto-captured
- post-tool-use
- file:build-issue-prompt.sh
---

...| as delimiter since paths may contain /
    # SFH-002: Include pipe character | in escape pattern since it's our sed delimiter
    local safe_title safe_path
    safe_title=$(printf '%s' "$issue_title...

---
type: patterns
timestamp: '2025-12-24T19:48:43.812829+00:00'
summary: '...whoami)secret123password"'''
tags:
- auto-captured
- post-tool-use
- file:test_pipeline.py
---

...whoami)secret123password"'
        result = filter_pipeline(text)
        # The password_assignment pattern should match and filter
        self.assertGreater(result.secret_count, 0)
        # The filtered...

---
type: patterns
timestamp: '2025-12-24T19:48:43.833612+00:00'
summary: '...com)EXAMPLE"'
tags:
- auto-captured
- post-tool-use
- file:test_pipeline.py
---

...com)EXAMPLE"
        result = filter_pipeline(text)
        # This should be detected as an AWS key pattern
        self.assertIn("aws_access_key", result.secret_types)

    def test_github_token_with_injection...

---
type: patterns
timestamp: '2025-12-24T19:48:43.854892+00:00'
summary: '...# JWT format but with script injection in payload'
tags:
- auto-captured
- post-tool-use
- file:test_pipeline.py
---

...# JWT format but with script injection in payload
        # Note: This tests that JWT pattern still matches even with unusual content
        header = base64.b64encode(b'{"alg":"HS256"}').decode...

---
type: patterns
timestamp: '2025-12-24T19:48:43.875531+00:00'
summary: '...f"ey{header[2:]}.ey{payload_b64}.{signature}"'
tags:
- auto-captured
- post-tool-use
- file:test_pipeline.py
---

...f"ey{header[2:]}.ey{payload_b64}.{signature}"

        result = filter_pipeline(jwt)
        # JWT pattern should still match the overall structure
        self.assertGreater(result.secret_count, 0)

if...

---
type: patterns
timestamp: '2025-12-24T19:49:36.217985+00:00'
summary: '...AKIAIOSFODNN7EXAMPLE)"'''
tags:
- auto-captured
- post-tool-use
- file:test_pipeline.py
---

...AKIAIOSFODNN7EXAMPLE)"'
        result = filter_pipeline(text)
        # The aws_secret_key pattern should match (key in quotes context)
        self.assertGreater(result.secret_count, 0)
